@page "/weather"
@using Microsoft.EntityFrameworkCore
@attribute [StreamRendering]
@rendermode InteractiveServer
@inject Services.DataService DataService
 
<PageTitle>Weather</PageTitle>

<h1>Weather</h1>

<p>This component demonstrates showing data.</p>

<MudDataGrid T="FloatTableP1_Table" MultiSelection="false" Hover="true" Hideable="true" Items="@forecasts" >
    <Columns>
        <PropertyColumn Property="x => x.DateAndTime" Title="Assigned by"/>
        <PropertyColumn Property="x => x.Millitm" />
        <PropertyColumn Property="x => x.TagIndex" />
        <PropertyColumn Property="x => x.Val" />
        <PropertyColumn Property="x => x.Status"></PropertyColumn>
        <PropertyColumn Property="x => x.Marker"></PropertyColumn>
    </Columns>

    <PagerContent>
        <MudDataGridPager T="FloatTableP1_Table" />
    </PagerContent>
</MudDataGrid>

@code {
    private List<FloatTableP1_Table>? forecasts = null;
    
    protected override async Task OnInitializedAsync()
    {
        try
        {
            forecasts = await DataService.SkipIrrelevant<FloatTableP1_Table>();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading data: {ex.Message}");
            forecasts = new List<FloatTableP1_Table>(); // Ensure forecasts is never null
        }
    }
}
